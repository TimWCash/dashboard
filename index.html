<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dublin Public Bathroom Finder</title>

    <!-- Leaflet CSS for interactive maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0066cc;
            --primary-dark: #0052a3;
            --secondary: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-600: #6c757d;
            --gray-800: #343a40;
            --gray-900: #212529;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--gray-100);
            color: var(--gray-800);
            line-height: 1.6;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 1rem 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1000;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header-icon {
            font-size: 2rem;
        }

        h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .subtitle {
            font-size: 0.875rem;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 380px;
            background: white;
            border-right: 1px solid var(--gray-300);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .search-section {
            padding: 1.25rem;
            border-bottom: 1px solid var(--gray-300);
            background: var(--gray-100);
        }

        .search-box {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.75rem;
            border: 2px solid var(--gray-300);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.25rem;
            color: var(--gray-600);
        }

        .filter-section {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--gray-300);
            background: white;
            border-radius: 20px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .results-section {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .results-count {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .bathroom-card {
            background: white;
            border: 1px solid var(--gray-300);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .bathroom-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
            border-color: var(--primary);
        }

        .bathroom-card.selected {
            border-color: var(--primary);
            background: #f0f7ff;
        }

        .bathroom-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }

        .bathroom-address {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: start;
            gap: 0.5rem;
        }

        .bathroom-features {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .feature-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.625rem;
            background: var(--gray-200);
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .feature-badge.accessible {
            background: #d1e7dd;
            color: #0a3622;
        }

        .feature-badge.free {
            background: #cfe2ff;
            color: #052c65;
        }

        .feature-badge.paid {
            background: #fff3cd;
            color: #664d03;
        }

        /* Map Container */
        .map-container {
            flex: 1;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* Custom Leaflet Popup */
        .custom-popup {
            font-family: 'Inter', sans-serif;
        }

        .popup-name {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--gray-900);
        }

        .popup-address {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-bottom: 0.5rem;
        }

        .popup-features {
            display: flex;
            flex-wrap: wrap;
            gap: 0.375rem;
            margin-top: 0.5rem;
        }

        .directions-btn {
            display: inline-block;
            margin-top: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            text-align: center;
            transition: background 0.2s;
        }

        .directions-btn:hover {
            background: var(--primary-dark);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }

            h1 {
                font-size: 1.25rem;
            }

            .main-content {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                max-height: 40vh;
                border-right: none;
                border-bottom: 1px solid var(--gray-300);
            }

            .map-container {
                height: 60vh;
            }
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--gray-600);
        }

        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid var(--gray-300);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Legend */
        .legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1000;
            font-size: 0.875rem;
        }

        .legend-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.375rem 0;
        }

        .legend-icon {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-icon.free {
            background: #28a745;
        }

        .legend-icon.paid {
            background: #ffc107;
        }

        .legend-icon.accessible {
            background: #0066cc;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-title">
                    <div class="header-icon">üöª</div>
                    <div>
                        <h1>Dublin Public Bathroom Finder</h1>
                        <div class="subtitle">Find accessible public restrooms across Dublin</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="search-section">
                    <div class="search-box">
                        <span class="search-icon">üîç</span>
                        <input
                            type="text"
                            class="search-input"
                            id="searchInput"
                            placeholder="Search by name or location..."
                        >
                    </div>
                    <div class="filter-section">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="free">Free</button>
                        <button class="filter-btn" data-filter="accessible">Accessible</button>
                        <button class="filter-btn" data-filter="24h">24 Hours</button>
                    </div>
                </div>

                <div class="results-section" id="resultsSection">
                    <div class="results-count" id="resultsCount">Loading bathrooms...</div>
                    <div id="bathroomList"></div>
                </div>
            </aside>

            <!-- Map -->
            <div class="map-container">
                <div id="map"></div>
                <div class="legend">
                    <div class="legend-title">Legend</div>
                    <div class="legend-item">
                        <div class="legend-icon free"></div>
                        <span>Free</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon paid"></div>
                        <span>Paid</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon accessible"></div>
                        <span>Accessible</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // Dublin Public Bathroom Data
        const bathrooms = [
            {
                id: 1,
                name: "St. Stephen's Green Public Toilets",
                lat: 53.3381,
                lng: -6.2592,
                address: "St Stephen's Green, Dublin 2",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Baby Changing"]
            },
            {
                id: 2,
                name: "Temple Bar Public Toilets",
                lat: 53.3456,
                lng: -6.2644,
                address: "Temple Bar Square, Dublin 2",
                type: "paid",
                accessible: true,
                hours24: false,
                features: ["Paid ‚Ç¨0.50", "Accessible", "Clean"]
            },
            {
                id: 3,
                name: "O'Connell Street Public Toilets",
                lat: 53.3498,
                lng: -6.2603,
                address: "O'Connell Street Lower, Dublin 1",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Central Location"]
            },
            {
                id: 4,
                name: "Phoenix Park Visitor Centre",
                lat: 53.3559,
                lng: -6.3298,
                address: "Phoenix Park, Dublin 8",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Parking Available"]
            },
            {
                id: 5,
                name: "Grafton Street Public Facilities",
                lat: 53.3429,
                lng: -6.2602,
                address: "Grafton Street, Dublin 2",
                type: "paid",
                accessible: true,
                hours24: false,
                features: ["Paid ‚Ç¨0.40", "Accessible", "Shopping Area"]
            },
            {
                id: 6,
                name: "Trinity College Public Toilets",
                lat: 53.3438,
                lng: -6.2546,
                address: "College Green, Dublin 2",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Historic Location"]
            },
            {
                id: 7,
                name: "Merrion Square Park Facilities",
                lat: 53.3396,
                lng: -6.2496,
                address: "Merrion Square, Dublin 2",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Park Setting"]
            },
            {
                id: 8,
                name: "Dublin Castle Public Toilets",
                lat: 53.3429,
                lng: -6.2674,
                address: "Dame Street, Dublin 2",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Tourist Area"]
            },
            {
                id: 9,
                name: "Smithfield Square Facilities",
                lat: 53.3474,
                lng: -6.2776,
                address: "Smithfield, Dublin 7",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Modern"]
            },
            {
                id: 10,
                name: "Grand Canal Dock Public Toilets",
                lat: 53.3431,
                lng: -6.2391,
                address: "Grand Canal Dock, Dublin 2",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Waterfront"]
            },
            {
                id: 11,
                name: "Parnell Street Public Facilities",
                lat: 53.3526,
                lng: -6.2627,
                address: "Parnell Street, Dublin 1",
                type: "paid",
                accessible: true,
                hours24: true,
                features: ["Paid ‚Ç¨0.30", "Accessible", "24 Hours"]
            },
            {
                id: 12,
                name: "Christchurch Cathedral Facilities",
                lat: 53.3433,
                lng: -6.2713,
                address: "Christchurch Place, Dublin 8",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Historic"]
            },
            {
                id: 13,
                name: "Herbert Park Public Toilets",
                lat: 53.3252,
                lng: -6.2285,
                address: "Herbert Park, Ballsbridge, Dublin 4",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Park", "Playground Nearby"]
            },
            {
                id: 14,
                name: "Bus√°ras Bus Station Facilities",
                lat: 53.3506,
                lng: -6.2509,
                address: "Store Street, Dublin 1",
                type: "paid",
                accessible: true,
                hours24: true,
                features: ["Paid ‚Ç¨0.50", "Accessible", "24 Hours", "Transport Hub"]
            },
            {
                id: 15,
                name: "Docklands Riverside Facilities",
                lat: 53.3462,
                lng: -6.2389,
                address: "North Wall Quay, Dublin 1",
                type: "free",
                accessible: true,
                hours24: false,
                features: ["Free", "Accessible", "Modern", "Riverside"]
            }
        ];

        // Initialize map centered on Dublin
        const map = L.map('map').setView([53.3498, -6.2603], 13);

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        }).addTo(map);

        // Store markers for filtering
        let markers = [];
        let selectedBathroomId = null;

        // Custom icon function
        function getMarkerIcon(bathroom) {
            let color = bathroom.type === 'free' ? '#28a745' : '#ffc107';
            if (bathroom.accessible) color = '#0066cc';

            return L.divIcon({
                className: 'custom-marker',
                html: `<div style="
                    background-color: ${color};
                    width: 30px;
                    height: 30px;
                    border-radius: 50% 50% 50% 0;
                    transform: rotate(-45deg);
                    border: 3px solid white;
                    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
                ">
                    <div style="
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(45deg);
                        font-size: 16px;
                    ">üöª</div>
                </div>`,
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });
        }

        // Create popup content
        function createPopupContent(bathroom) {
            const features = bathroom.features.map(f =>
                `<span class="feature-badge ${f.toLowerCase().includes('free') ? 'free' : f.toLowerCase().includes('paid') ? 'paid' : f.toLowerCase().includes('accessible') ? 'accessible' : ''}">${f}</span>`
            ).join('');

            return `
                <div class="custom-popup">
                    <div class="popup-name">${bathroom.name}</div>
                    <div class="popup-address">üìç ${bathroom.address}</div>
                    <div class="popup-features">${features}</div>
                    <a href="https://www.google.com/maps/dir/?api=1&destination=${bathroom.lat},${bathroom.lng}"
                       target="_blank"
                       class="directions-btn">
                        Get Directions ‚Üí
                    </a>
                </div>
            `;
        }

        // Add markers to map
        function addMarkers(bathroomsToShow = bathrooms) {
            // Clear existing markers
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            bathroomsToShow.forEach(bathroom => {
                const marker = L.marker([bathroom.lat, bathroom.lng], {
                    icon: getMarkerIcon(bathroom)
                }).addTo(map);

                marker.bindPopup(createPopupContent(bathroom));

                marker.on('click', () => {
                    selectedBathroomId = bathroom.id;
                    updateBathroomList(bathroomsToShow);

                    // Scroll to selected card
                    const card = document.querySelector(`[data-id="${bathroom.id}"]`);
                    if (card) {
                        card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }
                });

                markers.push(marker);
            });
        }

        // Create bathroom card
        function createBathroomCard(bathroom) {
            const features = bathroom.features.map(f =>
                `<span class="feature-badge ${f.toLowerCase().includes('free') ? 'free' : f.toLowerCase().includes('paid') ? 'paid' : f.toLowerCase().includes('accessible') ? 'accessible' : ''}">${f}</span>`
            ).join('');

            return `
                <div class="bathroom-card ${bathroom.id === selectedBathroomId ? 'selected' : ''}" data-id="${bathroom.id}">
                    <div class="bathroom-name">${bathroom.name}</div>
                    <div class="bathroom-address">
                        <span>üìç</span>
                        <span>${bathroom.address}</span>
                    </div>
                    <div class="bathroom-features">${features}</div>
                </div>
            `;
        }

        // Update bathroom list
        function updateBathroomList(bathroomsToShow = bathrooms) {
            const listContainer = document.getElementById('bathroomList');
            const countElement = document.getElementById('resultsCount');

            countElement.textContent = `Found ${bathroomsToShow.length} bathroom${bathroomsToShow.length !== 1 ? 's' : ''}`;

            listContainer.innerHTML = bathroomsToShow.map(createBathroomCard).join('');

            // Add click handlers to cards
            document.querySelectorAll('.bathroom-card').forEach(card => {
                card.addEventListener('click', () => {
                    const id = parseInt(card.dataset.id);
                    const bathroom = bathrooms.find(b => b.id === id);

                    if (bathroom) {
                        selectedBathroomId = id;
                        map.setView([bathroom.lat, bathroom.lng], 16);

                        // Find and open the marker popup
                        markers.forEach(marker => {
                            if (marker.getLatLng().lat === bathroom.lat &&
                                marker.getLatLng().lng === bathroom.lng) {
                                marker.openPopup();
                            }
                        });

                        updateBathroomList(bathroomsToShow);
                    }
                });
            });
        }

        // Filter functionality
        let currentFilter = 'all';
        let currentSearch = '';

        function applyFilters() {
            let filtered = bathrooms;

            // Apply type filter
            if (currentFilter !== 'all') {
                if (currentFilter === 'free') {
                    filtered = filtered.filter(b => b.type === 'free');
                } else if (currentFilter === 'accessible') {
                    filtered = filtered.filter(b => b.accessible);
                } else if (currentFilter === '24h') {
                    filtered = filtered.filter(b => b.hours24);
                }
            }

            // Apply search filter
            if (currentSearch) {
                const search = currentSearch.toLowerCase();
                filtered = filtered.filter(b =>
                    b.name.toLowerCase().includes(search) ||
                    b.address.toLowerCase().includes(search) ||
                    b.features.some(f => f.toLowerCase().includes(search))
                );
            }

            addMarkers(filtered);
            updateBathroomList(filtered);
        }

        // Filter button handlers
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                applyFilters();
            });
        });

        // Search input handler
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', (e) => {
            currentSearch = e.target.value;
            applyFilters();
        });

        // Initialize the app
        addMarkers();
        updateBathroomList();
    </script>
</body>
</html>
